# 控制器参数调试记录

## 评分公式
```
overall_score = 200 × RMSE + 0.2 × 时间 + 0.2 × 长度 + 40 × 碰撞
```

---

## 调参结果汇总（按得分排序）

| 排名 | 策略 | kx [x, y, z] | kv [x, y, z] | RMSE | 时间(s) | 长度(m) | 碰撞 | 综合分 |
|:----:|------|-------------|-------------|------|---------|---------|:----:|--------|
| **1** | **策略6** | **[21.0, 21.0, 13.0]** | **[11.0, 11.0, 7.0]** | **0.098** | **92.98** | **36.47** | 1 | **85.47** |
| 2 | 策略5 | [20.0, 20.0, 12.0] | [11.0, 11.0, 7.0] | 0.162 | 54.18 | 32.31 | 1 | 89.60 |
| 3 | 策略1 | [20.0, 20.0, 12.0] | [10.0, 10.0, 6.0] | 0.164 | 51.82 | 33.52 | 1 | 89.82 |
| 4 | 策略8 | [22.0, 22.0, 14.0] | [11.0, 11.0, 7.0] | 0.149 | 76.62 | 51.08 | 1 | 95.29 |
| 5 | 策略2 | [18.0, 18.0, 10.0] | [14.0, 14.0, 8.0] | 0.161 | 86.48 | 53.73 | 1 | 100.28 |
| 6 | 策略4 | [24.0, 24.0, 15.0] | [11.0, 11.0, 7.0] | 0.242 | 49.86 | 34.07 | 1 | 105.28 |
| 7 | 默认 | [15.7, 8.7, 6.0] | [6.4, 13.4, 4.0] | 0.234 | 107.61 | 39.23 | 1 | 116.18 |
| 8 | 策略3 | [22.0, 22.0, 14.0] | [10.0, 10.0, 6.0] | 0.221 | 115.41 | 50.87 | 1 | 117.54 |
| 9 | 策略7 | [20.0, 20.0, 12.0] | [10.0, 10.0, 6.5] | 0.644 | 75.80 | 60.19 | 1 | 195.91 |

---

## 🏆 最优参数（策略6）

```cpp
kx_ = Eigen::Vector3d(21.0, 21.0, 13.0);
kv_ = Eigen::Vector3d(11.0, 11.0, 7.0);
```

### 得分分解
| 指标 | 值 | 权重 | 贡献分 | 占比 |
|------|-----|------|--------|------|
| RMSE | 0.098 | ×200 | 19.58 | 23% |
| 时间 | 92.98s | ×0.2 | 18.60 | 22% |
| 长度 | 36.47m | ×0.2 | 7.29 | 9% |
| 碰撞 | 1次 | ×40 | 40.00 | 47% |
| **总分** | - | - | **85.47** | 100% |

### 理论最优（无碰撞情况）
如果消除碰撞，预估得分：
```
19.58 + 18.60 + 7.29 + 0 = 45.47 分
```

---

## 调参总结

### 1. 关键发现

| 发现 | 说明 |
|------|------|
| **策略6 RMSE最低** | 0.098，远优于其他策略 |
| **kx=21 更优** | 比 kx=20 的 RMSE 提升 40% |
| **kv=11 稳定** | 保持适中阻尼效果好 |
| **碰撞仍是主要扣分项** | 占总分 47% |

### 2. 参数规律

| 参数组合 | kx/kv比值 | RMSE | 效果 |
|----------|-----------|------|------|
| 策略6（最优） | 21/11 ≈ 1.9 | 0.098 | RMSE最低 |
| 策略5 | 20/11 ≈ 1.8 | 0.162 | 平衡 |
| 策略8 | 22/11 = 2.0 | 0.149 | 响应过快 |
| 策略7 | 20/10 = 2.0 | 0.644 | 阻尼不足，振荡 |

**最佳 kx/kv 比值：约 1.9**

### 3. 调参经验

1. **kx = 21** 是当前最优位置增益
2. **kv = 11** 提供足够阻尼
3. **Z轴 kx_z=13, kv_z=7** 略保守
4. **降低 kv 会导致振荡**（策略7 失败）

---

## 最终推荐参数

```cpp
// 文件：so3_control/src/so3_control_nodelet.cpp
// 函数：position_cmd_callback

kx_ = Eigen::Vector3d(21.0, 21.0, 13.0);
kv_ = Eigen::Vector3d(11.0, 11.0, 7.0);
```

**相比默认参数提升：116.18 → 85.47（降低 26%）**
**RMSE 提升：0.234 → 0.098（降低 58%）**
